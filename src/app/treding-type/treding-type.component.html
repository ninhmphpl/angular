<div class="container my-2">
  <table class="table table-hover table-bordered">
    <tbody>
    <tr>
      <td colspan="5">
        <button class="btn btn-primary" (click)="api.createTrendingType()">Create TrendingType</button>
        <app-upload-multiple [buttonName]="'Create Trending Multiple'"
                             (dataEvent)="api.createTrendingType($event)"></app-upload-multiple>
      </td>
    </tr>
    <tr>
      <td>Url</td>
      <td>Name</td>
      <td>Top</td>
      <td>Value</td>
      <td>Icons</td>
      <td>Required Version</td>
      <td>Step</td>
      <td>Delete</td>
    </tr>
    <tr *ngFor="let trendingType of api.trendingTypes let i = index">
      <td>
        <app-upload-cloud-flare [img]="trendingType.url"
                                (dataEvent)="trendingType.url = $event; api.updateTrendingType(i)"></app-upload-cloud-flare>
      </td>
      <td><input class="form-control" type="text" [(ngModel)]="trendingType.name" (change)="api.updateTrendingType(i)">
      </td>
      <td><input class="form-control" type="number" [(ngModel)]="trendingType.top" (change)="api.updateTrendingType(i)">
      </td>
      <td><input class="form-control" type="number" [(ngModel)]="trendingType.value"
                 (change)="api.updateTrendingType(i)"></td>
      <td>
        <div *ngFor="let icon of trendingType.icons, let j = index" class="btn-group">
          <img width="50px" height="50px" [src]="icon" alt="" class="img-thumbnail">
          <button class="btn btn-outline-danger" (click)="trendingType.icons.splice(j,1); api.updateTrendingType(i)">X
          </button>
        </div>
        <app-upload-cloud-flare [img]="'https://th.bing.com/th/id/OIP.trHoVYY45yfEDuRs3HklwwHaId?rs=1&pid=ImgDetMain'"
                                [imgWith]="'50px'" [imgHeight]="'50px'"
                                (dataEvent)="addIcon(i, $event);api.updateTrendingType(i) "
        ></app-upload-cloud-flare>
      </td>
      <td><input class="form-control" type="number" [(ngModel)]="trendingType.requiredVersion"
                 (change)="api.updateTrendingType(i)"></td>

      <td>
        <button class="btn btn-primary" (click)="makeStep(i, modalMakeStep, modalEdit)">Step</button>
      </td>
      <td>
        <button class="btn btn-primary" (click)="api.deleteTrendingType(i)">Delete</button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div>
  <!-- Button trigger modal -->
  <button [hidden]="true" #modalMakeStep class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal1">
    Launch demo modal
  </button>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Step Option</h1>
          <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <table>
            <tr>
              <td class="col-3">Width</td>
              <td><input class="form-control" type="text" [(ngModel)]="widthSelect"></td>
            </tr>
            <tr>
              <td class="col-3">Height</td>
              <td><input class="form-control" type="text" [(ngModel)]="heightSelect"></td>
            </tr>
          </table>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button class="btn btn-primary" (click)="makeStepSubmit()">Make Step</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div>
  <!-- Button trigger modal -->
  <button [hidden]="true" #modalEdit class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalEdit">
    Launch demo modal
  </button>

  <!-- Modal -->
  <div class="modal fade" id="modalEdit" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-between align-items-center">
          <div class="col">
            <h1 class="modal-title fs-5">Edit Step</h1>
          </div>
          <div class="col">
            <div class="input-group">
              <div>
                <div class="input-group">
                  <span [style.width]="'100px'" class="input-group-text">width</span>
                  <input [style.width]="'100px'" class="form-control" type="number" placeholder="Width" [(ngModel)]="api.trendingTypes[indexSelect].step.width">
                </div>
                <div class="input-group">
                  <span [style.width]="'100px'" class="input-group-text">height</span>
                  <input [style.width]="'100px'" class="form-control" type="number" placeholder="Height" [(ngModel)]="api.trendingTypes[indexSelect].step.height">
                </div>
              </div>
              <button (click)="updateStepSubmit()" class="btn btn-primary">Edit Size</button>
            </div>
          </div>
        </div>
        <div class="modal-body d-flex justify-content-center align-items-center">
          <div class="position-relative"
               [style.width]="100 * api.trendingTypes[indexSelect].step.width  + 'px'"
               [style.height]="100 * api.trendingTypes[indexSelect].step.height + 'px'">
            <div *ngFor="let point of api.trendingTypes[indexSelect].step.points, let i = index"
                 class="position-absolute"
                 [style.top]="100 * point.row + 'px'"
                 [style.left]="100 * point.column + 'px'">
              <button class="text-center border-0 rounded-circle" [ngClass]="point.state == 'none' ? 'bg-white' : 'bg-light' " (click)="editStep(i)"  [style.width]="'90px'" [style.height]="'90px'">{{point.state}}</button>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button #closeEditStep class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button class="btn btn-primary" (click)="api.updateTrendingType(indexSelect); closeEditStep.click()">Save changes</button>
        </div>
      </div>
    </div>
  </div>
</div>
